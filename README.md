# Kong Demo: try_demo_no_p

## ğŸ—ï¸ Multi-Service Architecture

This demo includes **2 services**:

- ğŸ”§ **booking-service**: Available at `booking-service/openapi.yaml`
- ğŸ”§ **notification-service**: Available at `notification-service/openapi.yaml`


## ğŸš€ Build Pipelines

### Multi-Service Pipeline (Recommended)
- **File**: `.github/workflows/build-multi-service.yml`
- **Purpose**: Builds all services together and creates a unified Kong configuration
- **Output**: `platform/kong/.generated/kong.yaml` (combined configuration)

### Individual Service Pipelines (Backup)
- **booking-service**: `.github/workflows/build-booking-service.yml`
- **notification-service**: `.github/workflows/build-notification-service.yml`


## ğŸ“ Directory Structure

```
try_demo_no_p/
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ build-multi-service.yml         # ğŸŒŸ Multi-service pipeline
â”‚   â”‚   â”œâ”€â”€ build-booking-service.yml          # Individual service pipeline
â”‚   â”œâ”€â”€ deploy-booking-service.yml         # Individual service deployment
â”‚   â”‚   â”œâ”€â”€ build-notification-service.yml          # Individual service pipeline
â”‚   â”œâ”€â”€ deploy-notification-service.yml         # Individual service deployment
â”‚   â”œâ”€â”€ platform/kong/
â”‚   â””â”€â”€ .generated/
â”‚       â””â”€â”€ kong.yaml                   # ğŸ¯ Final unified configuration
â”œâ”€â”€ booking-service/
â”‚   â”œâ”€â”€ openapi.yaml                    # OpenAPI specification
â”‚   â””â”€â”€ kong/
â”‚       â”œâ”€â”€ plugins/                    # Service-specific plugins
â”‚       â”‚   â””â”€â”€ empty-plugins.yaml      # Created if no specific plugins
â”‚       â””â”€â”€ .generated/                 # Generated configs
â”œâ”€â”€ notification-service/
â”‚   â”œâ”€â”€ openapi.yaml                    # OpenAPI specification
â”‚   â””â”€â”€ kong/
â”‚       â”œâ”€â”€ plugins/                    # Service-specific plugins
â”‚       â”‚   â””â”€â”€ empty-plugins.yaml      # Created if no specific plugins
â”‚       â””â”€â”€ .generated/                 # Generated configs
â””â”€â”€ kong/
    â”œâ”€â”€ plugins/                        # ğŸŒ Global plugins
    â””â”€â”€ consumers/                      # ğŸŒ Global consumers
```

## ğŸ”§ Plugin Configuration

### Global Plugins
- Location: `kong/plugins/*.yaml`
- Applied to: **All services**

### Service-Specific Plugins
- **booking-service**: `booking-service/kong/plugins/*.yaml`
  - If no specific plugins: `empty-plugins.yaml` with `plugins: []`
- **notification-service**: `notification-service/kong/plugins/*.yaml`
  - If no specific plugins: `empty-plugins.yaml` with `plugins: []`


### Empty Plugin Handling
Services without specific plugins get an `empty-plugins.yaml` file:
```yaml
plugins: []
```

## ğŸ‘¥ Consumer Configuration

- Location: `kong/consumers/*.yaml`
- Scope: **Global** (available to all services)

## ğŸ”„ Workflow Process

### Multi-Service Build Process:
1. **Change Detection**: Monitors all service specs and configurations
2. **Individual Conversion**: Converts each service's OpenAPI â†’ Kong config
3. **Plugin Processing**: 
   - Merges actual plugin files (ignores `empty-plugins.yaml`)
   - Services with only `empty-plugins.yaml` get no service-specific plugins
4. **Global Merging**: Combines all services + global plugins/consumers
5. **Final Generation**: Creates unified `platform/kong/.generated/kong.yaml`
6. **Validation**: Validates the final Kong configuration
7. **PR Creation**: Creates pull request with changes

### Triggered by changes to:
- `booking-service/openapi.yaml`
- `booking-service/kong/**`
- `notification-service/openapi.yaml`
- `notification-service/kong/**`
- `kong/plugins/**` (global plugins)
- `kong/consumers/**` (global consumers)

## ğŸ·ï¸ Tags

- **Demo-wide tag**: `try_demo_no_p`
- **Service tags**: 
- `booking-service`
- `notification-service`


---

*This demo was generated by Kong Demo Generator with multi-service capabilities.*