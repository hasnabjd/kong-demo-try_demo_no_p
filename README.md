# Kong Demo: try_demo_no_p

## 🏗️ Multi-Service Architecture

This demo includes **2 services**:

- 🔧 **booking-service**: Available at `booking-service/openapi.yaml`
- 🔧 **notification-service**: Available at `notification-service/openapi.yaml`


## 🚀 Build Pipelines

### Multi-Service Pipeline (Recommended)
- **File**: `.github/workflows/build-multi-service.yml`
- **Purpose**: Builds all services together and creates a unified Kong configuration
- **Output**: `platform/kong/.generated/kong.yaml` (combined configuration)

### Individual Service Pipelines (Backup)
- **booking-service**: `.github/workflows/build-booking-service.yml`
- **notification-service**: `.github/workflows/build-notification-service.yml`


## 📁 Directory Structure

```
try_demo_no_p/
├── .github/workflows/
│   ├── build-multi-service.yml         # 🌟 Multi-service pipeline
│   │   ├── build-booking-service.yml          # Individual service pipeline
│   ├── deploy-booking-service.yml         # Individual service deployment
│   │   ├── build-notification-service.yml          # Individual service pipeline
│   ├── deploy-notification-service.yml         # Individual service deployment
│   ├── platform/kong/
│   └── .generated/
│       └── kong.yaml                   # 🎯 Final unified configuration
├── booking-service/
│   ├── openapi.yaml                    # OpenAPI specification
│   └── kong/
│       ├── plugins/                    # Service-specific plugins
│       │   └── empty-plugins.yaml      # Created if no specific plugins
│       └── .generated/                 # Generated configs
├── notification-service/
│   ├── openapi.yaml                    # OpenAPI specification
│   └── kong/
│       ├── plugins/                    # Service-specific plugins
│       │   └── empty-plugins.yaml      # Created if no specific plugins
│       └── .generated/                 # Generated configs
└── kong/
    ├── plugins/                        # 🌐 Global plugins
    └── consumers/                      # 🌐 Global consumers
```

## 🔧 Plugin Configuration

### Global Plugins
- Location: `kong/plugins/*.yaml`
- Applied to: **All services**

### Service-Specific Plugins
- **booking-service**: `booking-service/kong/plugins/*.yaml`
  - If no specific plugins: `empty-plugins.yaml` with `plugins: []`
- **notification-service**: `notification-service/kong/plugins/*.yaml`
  - If no specific plugins: `empty-plugins.yaml` with `plugins: []`


### Empty Plugin Handling
Services without specific plugins get an `empty-plugins.yaml` file:
```yaml
plugins: []
```

## 👥 Consumer Configuration

- Location: `kong/consumers/*.yaml`
- Scope: **Global** (available to all services)

## 🔄 Workflow Process

### Multi-Service Build Process:
1. **Change Detection**: Monitors all service specs and configurations
2. **Individual Conversion**: Converts each service's OpenAPI → Kong config
3. **Plugin Processing**: 
   - Merges actual plugin files (ignores `empty-plugins.yaml`)
   - Services with only `empty-plugins.yaml` get no service-specific plugins
4. **Global Merging**: Combines all services + global plugins/consumers
5. **Final Generation**: Creates unified `platform/kong/.generated/kong.yaml`
6. **Validation**: Validates the final Kong configuration
7. **PR Creation**: Creates pull request with changes

### Triggered by changes to:
- `booking-service/openapi.yaml`
- `booking-service/kong/**`
- `notification-service/openapi.yaml`
- `notification-service/kong/**`
- `kong/plugins/**` (global plugins)
- `kong/consumers/**` (global consumers)

## 🏷️ Tags

- **Demo-wide tag**: `try_demo_no_p`
- **Service tags**: 
- `booking-service`
- `notification-service`


---

*This demo was generated by Kong Demo Generator with multi-service capabilities.*